gpu024
Loading validation data for ['visualnews', 'fashion200k', 'mscoco']
Validation with 29860 text and 46561 image retrieval tasks.
Validation domain details: visualnews(39996), fashion200k(6606), mscoco(29819)
Validation data loaded.
Validation candidates loaded.

  0%|          | 0/75 [00:00<?, ?it/s]
  3%|▎         | 2/75 [00:31<19:25, 15.96s/it]
  4%|▍         | 3/75 [01:02<26:29, 22.08s/it]
  5%|▌         | 4/75 [01:34<30:21, 25.66s/it]
  7%|▋         | 5/75 [02:04<31:42, 27.18s/it]
  8%|▊         | 6/75 [02:36<33:22, 29.02s/it]
  9%|▉         | 7/75 [03:06<33:14, 29.33s/it]
 11%|█         | 8/75 [03:37<33:06, 29.65s/it]
 12%|█▏        | 9/75 [04:08<33:06, 30.09s/it]
 13%|█▎        | 10/75 [04:39<32:54, 30.38s/it]
 15%|█▍        | 11/75 [05:10<32:35, 30.56s/it]
 16%|█▌        | 12/75 [05:41<32:19, 30.79s/it]
 17%|█▋        | 13/75 [06:13<31:58, 30.95s/it]
 19%|█▊        | 14/75 [06:43<31:15, 30.74s/it]
 20%|██        | 15/75 [07:14<30:47, 30.79s/it]
 21%|██▏       | 16/75 [07:45<30:22, 30.88s/it]
 23%|██▎       | 17/75 [08:15<29:33, 30.58s/it]
 24%|██▍       | 18/75 [08:44<28:49, 30.34s/it]
 25%|██▌       | 19/75 [09:14<28:05, 30.09s/it]
 27%|██▋       | 20/75 [09:44<27:34, 30.08s/it]
 28%|██▊       | 21/75 [10:15<27:14, 30.26s/it]
 29%|██▉       | 22/75 [10:45<26:38, 30.17s/it]
 31%|███       | 23/75 [11:14<26:00, 30.01s/it]
 32%|███▏      | 24/75 [11:44<25:32, 30.05s/it]
 33%|███▎      | 25/75 [12:15<25:12, 30.26s/it]
 35%|███▍      | 26/75 [12:46<24:50, 30.42s/it]
 36%|███▌      | 27/75 [13:17<24:31, 30.66s/it]
 37%|███▋      | 28/75 [13:49<24:11, 30.88s/it]
 39%|███▊      | 29/75 [14:19<23:30, 30.67s/it]
 40%|████      | 30/75 [14:49<22:56, 30.59s/it]
 41%|████▏     | 31/75 [15:20<22:25, 30.58s/it]
 43%|████▎     | 32/75 [15:51<21:57, 30.65s/it]
 44%|████▍     | 33/75 [16:21<21:26, 30.63s/it]
 45%|████▌     | 34/75 [16:51<20:50, 30.51s/it]
 47%|████▋     | 35/75 [17:22<20:22, 30.56s/it]
 48%|████▊     | 36/75 [17:52<19:47, 30.45s/it]
 49%|████▉     | 37/75 [18:24<19:29, 30.77s/it]
 51%|█████     | 38/75 [18:55<19:03, 30.90s/it]
 52%|█████▏    | 39/75 [19:26<18:29, 30.83s/it]
 53%|█████▎    | 40/75 [19:56<17:52, 30.65s/it]
 55%|█████▍    | 41/75 [20:26<17:14, 30.42s/it]
 56%|█████▌    | 42/75 [20:57<16:53, 30.71s/it]
 57%|█████▋    | 43/75 [21:27<16:19, 30.60s/it]
 59%|█████▊    | 44/75 [21:58<15:47, 30.56s/it]
 60%|██████    | 45/75 [22:28<15:15, 30.51s/it]
 61%|██████▏   | 46/75 [22:59<14:44, 30.51s/it]
 63%|██████▎   | 47/75 [23:28<14:00, 30.03s/it]
 64%|██████▍   | 48/75 [23:58<13:30, 30.02s/it]
 65%|██████▌   | 49/75 [24:28<13:01, 30.04s/it]
 67%|██████▋   | 50/75 [24:58<12:33, 30.15s/it]
 68%|██████▊   | 51/75 [25:28<12:02, 30.08s/it]
 69%|██████▉   | 52/75 [25:59<11:36, 30.27s/it]
 71%|███████   | 53/75 [26:29<11:06, 30.29s/it]
 72%|███████▏  | 54/75 [26:59<10:32, 30.10s/it]
 73%|███████▎  | 55/75 [27:29<10:00, 30.02s/it]
 75%|███████▍  | 56/75 [27:59<09:30, 30.00s/it]
 76%|███████▌  | 57/75 [28:29<09:00, 30.01s/it]
 77%|███████▋  | 58/75 [28:59<08:31, 30.12s/it]
 79%|███████▊  | 59/75 [29:30<08:06, 30.42s/it]
 80%|████████  | 60/75 [30:01<07:36, 30.42s/it]
 81%|████████▏ | 61/75 [30:31<07:07, 30.52s/it]
 83%|████████▎ | 62/75 [31:02<06:35, 30.46s/it]
 84%|████████▍ | 63/75 [31:31<06:01, 30.11s/it]
 85%|████████▌ | 64/75 [32:01<05:30, 30.09s/it]
 87%|████████▋ | 65/75 [32:31<05:00, 30.08s/it]
 88%|████████▊ | 66/75 [33:01<04:30, 30.04s/it]
 89%|████████▉ | 67/75 [33:30<03:58, 29.83s/it]
 91%|█████████ | 68/75 [34:00<03:27, 29.69s/it]
 92%|█████████▏| 69/75 [34:29<02:57, 29.59s/it]
 93%|█████████▎| 70/75 [34:59<02:28, 29.63s/it]
 95%|█████████▍| 71/75 [35:29<01:59, 29.83s/it]
 96%|█████████▌| 72/75 [36:00<01:30, 30.03s/it]
 97%|█████████▋| 73/75 [36:30<01:00, 30.15s/it]
 99%|█████████▊| 74/75 [36:58<00:29, 29.47s/it]
100%|██████████| 75/75 [37:13<00:00, 25.31s/it]
100%|██████████| 75/75 [37:14<00:00, 29.80s/it]
***** eval metrics *****
  test_accuracy               =     0.6406
  test_loss                   =        0.0
  test_modality_accuracy      =     0.9885
  test_model_preparation_time =      0.005
  test_runtime                = 0:37:53.07
  test_samples_per_second     =      33.62
  test_steps_per_second       =      0.033

query embedding size: (76421, 768), ids: (76421,)
query embeddings saved to Results/Evaluation/clip-vit-large-patch14/MBIER/run_6/embeddings/

candidate embedding size: (100024, 768), ids: (100024,)
candidate embeddings saved to Results/Evaluation/clip-vit-large-patch14/MBIER/run_6/embeddings/
Creating index.
Traceback (most recent call last):
  File "/work/pi_pgrabowicz_umass_edu/kchimmad/Modality-Aware-MLLM-Retriever/mainEval.py", line 30, in <module>
    start('configEval.yaml')
  File "/work/pi_pgrabowicz_umass_edu/kchimmad/Modality-Aware-MLLM-Retriever/mainEval.py", line 24, in start
    create_index(Args)
  File "/work/pi_pgrabowicz_umass_edu/kchimmad/Modality-Aware-MLLM-Retriever/retriever/indexer.py", line 19, in create_index
    candidate_embeddings = np.load(candidate_embedding_path+'candidate_embed.npy')
  File "/home/kchimmad_umass_edu/.conda/envs/IR646/lib/python3.10/site-packages/numpy/lib/_npyio_impl.py", line 459, in load
    fid = stack.enter_context(open(os.fspath(file), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: 'Results/Evaluation/clip-vit-large-patch14/MBIER/run_3/tuned-model//embeddings/candidate_embed.npy'
